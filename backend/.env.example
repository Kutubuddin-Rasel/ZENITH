# ==============================================================================
# ZENITH PM - Environment Configuration
# ==============================================================================
# Copy this file to .env and configure for your environment.
# See docs/configuration.md for detailed documentation.
#
# Required variables are marked with [REQUIRED]
# Optional variables have sensible defaults
# ==============================================================================

# ------------------------------------------------------------------------------
# APPLICATION CONFIGURATION
# ------------------------------------------------------------------------------

# Environment: development, staging, production, test
NODE_ENV=development

# Backend API base URL (used for OAuth callbacks, webhooks, emails)
# [REQUIRED for production]
API_BASE_URL=http://localhost:3000

# Frontend application URL (used for redirects, CORS, emails)
# [REQUIRED for production]
FRONTEND_URL=http://localhost:3001

# Server port
PORT=3000

# CORS additional origins (comma-separated, for multi-domain deployments)
# Example: https://admin.example.com,https://mobile.example.com
CORS_ADDITIONAL_ORIGINS=

# CORS max age in seconds (preflight cache duration)
CORS_MAX_AGE=86400

# ------------------------------------------------------------------------------
# DATABASE CONFIGURATION
# ------------------------------------------------------------------------------
# Phase 4 Remediation: All database vars now use DATABASE_* prefix
# Old names (DB_HOST, DB_PORT, etc.) are deprecated and no longer supported.

# PostgreSQL connection (individual params - preferred for env-based config)
# [REQUIRED in production]
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_USER=postgres
DATABASE_PASS=password
DATABASE_NAME=zenith

# Connection URL (alternative to individual params)
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/zenith

# SSL Configuration (required for production cloud databases)
DATABASE_SSL_ENABLED=false
# CA certificate - Base64 encoded (preferred for K8s/12-factor)
DATABASE_SSL_CA=
# CA certificate - file path (alternative)
DATABASE_SSL_CA_PATH=

# Connection Pool Settings
DATABASE_POOL_MAX=20
DATABASE_POOL_MIN=5
DATABASE_POOL_ACQUIRE=30000
DATABASE_POOL_IDLE=10000

# Timeouts (milliseconds)
DATABASE_CONNECTION_TIMEOUT=2000
DATABASE_IDLE_TIMEOUT=30000
DATABASE_QUERY_TIMEOUT=60000
DATABASE_STATEMENT_TIMEOUT=30000
DATABASE_MAX_QUERY_TIME=5000

# Logging
DATABASE_LOGGING=false
DATABASE_QUERY_LOG=false

# Replication (read/write splitting - production only)
# DATABASE_MASTER_HOST=
# DATABASE_MASTER_PORT=
# DATABASE_MASTER_USER=
# DATABASE_MASTER_PASS=
# DATABASE_MASTER_NAME=
# DATABASE_SLAVE_HOST=
# DATABASE_SLAVE_PORT=
# DATABASE_SLAVE_USER=
# DATABASE_SLAVE_PASS=
# DATABASE_SLAVE_NAME=

# ------------------------------------------------------------------------------
# REDIS CONFIGURATION
# ------------------------------------------------------------------------------

# Redis connection
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# Redis database number
REDIS_DB=0

# Redis timeouts
REDIS_KEEP_ALIVE_MS=30000
REDIS_COMMAND_TIMEOUT_MS=3000

# ------------------------------------------------------------------------------
# AUTHENTICATION - JWT
# ------------------------------------------------------------------------------

# JWT secret for signing tokens
# [REQUIRED] - Use a strong random string (minimum 32 characters)
# Generate with: openssl rand -base64 32
JWT_SECRET=

# JWT refresh token secret (should be different from JWT_SECRET)
# [REQUIRED] - Use a strong random string
JWT_REFRESH_SECRET=

# Token expiry times
JWT_ACCESS_EXPIRY=15m
JWT_REFRESH_EXPIRY=7d
JWT_2FA_SESSION_EXPIRY=5m

# ------------------------------------------------------------------------------
# AUTHENTICATION - COOKIES
# ------------------------------------------------------------------------------

# Refresh token cookie TTL in days
REFRESH_TOKEN_TTL_DAYS=7

# Cookie domain (for cross-subdomain auth, e.g., .example.com)
COOKIE_DOMAIN=

# Force secure cookies (auto-enabled in production)
COOKIE_SECURE=false

# Cookie SameSite policy: strict, lax, none
COOKIE_SAME_SITE=lax

# ------------------------------------------------------------------------------
# AUTHENTICATION - PASSWORD POLICY
# ------------------------------------------------------------------------------

# Minimum password length (NIST recommends 8 minimum, we default to 12)
PASSWORD_MIN_LENGTH=12

# Maximum password length
PASSWORD_MAX_LENGTH=128

# Require complexity (uppercase, lowercase, number, special char)
PASSWORD_REQUIRE_COMPLEXITY=true

# ------------------------------------------------------------------------------
# AUTHENTICATION - TWO-FACTOR
# ------------------------------------------------------------------------------

# TOTP time window (number of 30-second intervals accepted)
# 1 = ±30 seconds, 2 = ±60 seconds
TOTP_WINDOW=1

# Number of recovery codes generated
TOTP_RECOVERY_CODES=8

# ------------------------------------------------------------------------------
# RATE LIMITING
# ------------------------------------------------------------------------------

# Global rate limit (requests per minute)
RATE_LIMIT_GLOBAL_LIMIT=100
RATE_LIMIT_GLOBAL_TTL_MS=60000

# Login rate limit (prevent brute force)
RATE_LIMIT_LOGIN_LIMIT=5
RATE_LIMIT_LOGIN_TTL_MS=60000

# Registration rate limit (prevent spam)
RATE_LIMIT_REGISTER_LIMIT=3
RATE_LIMIT_REGISTER_TTL_MS=60000

# 2FA rate limit
RATE_LIMIT_2FA_LIMIT=5
RATE_LIMIT_2FA_TTL_MS=60000

# Recovery rate limit (prevent email bombing)
RATE_LIMIT_RECOVERY_LIMIT=3
RATE_LIMIT_RECOVERY_TTL_MS=300000

# Password reset rate limit
RATE_LIMIT_PASSWORD_RESET_LIMIT=3
RATE_LIMIT_PASSWORD_RESET_TTL_MS=3600000

# ------------------------------------------------------------------------------
# CACHE CONFIGURATION
# ------------------------------------------------------------------------------

# Enable/disable caching globally
CACHE_ENABLED=true

# Cache key prefix (for multi-tenant Redis)
CACHE_KEY_PREFIX=zenith:

# TTL tiers (in seconds)
CACHE_TTL_MICRO=5
CACHE_TTL_SHORT=60
CACHE_TTL_MEDIUM=300
CACHE_TTL_LONG=900
CACHE_TTL_EXTENDED=3600
CACHE_TTL_DAILY=86400

# ------------------------------------------------------------------------------
# INTEGRATION - TIMEOUTS
# ------------------------------------------------------------------------------

# Default API call timeout
INTEGRATION_TIMEOUT_MS=30000

# AI API timeout (may take longer)
AI_API_TIMEOUT_MS=60000

# OAuth flow timeout
OAUTH_TIMEOUT_MS=30000

# ------------------------------------------------------------------------------
# INTEGRATION - CIRCUIT BREAKER
# ------------------------------------------------------------------------------

# Failures before opening circuit
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5

# Time to wait before attempting to close circuit
CIRCUIT_BREAKER_RESET_MS=30000

# Window for counting failures
CIRCUIT_BREAKER_WINDOW_MS=60000

# ------------------------------------------------------------------------------
# INTEGRATION - GITHUB
# ------------------------------------------------------------------------------

# GitHub OAuth App credentials (for OAuth flow)
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=

# GitHub App credentials (for GitHub App integration)
GITHUB_APP_ID=
GITHUB_PRIVATE_KEY=
GITHUB_WEBHOOK_SECRET=

# Override redirect URI (optional, defaults to API_BASE_URL + path)
# GITHUB_REDIRECT_URI=

# ------------------------------------------------------------------------------
# INTEGRATION - SLACK
# ------------------------------------------------------------------------------

SLACK_CLIENT_ID=
SLACK_CLIENT_SECRET=
SLACK_SIGNING_SECRET=
SLACK_BOT_TOKEN=

# Override redirect URI (optional)
# SLACK_REDIRECT_URI=

# ------------------------------------------------------------------------------
# INTEGRATION - JIRA
# ------------------------------------------------------------------------------

JIRA_CLIENT_ID=
JIRA_CLIENT_SECRET=

# Override redirect URI (optional)
# JIRA_REDIRECT_URI=

# ------------------------------------------------------------------------------
# INTEGRATION - GOOGLE
# ------------------------------------------------------------------------------

GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=

# Override redirect URI (optional)
# GOOGLE_REDIRECT_URI=

# ------------------------------------------------------------------------------
# INTEGRATION - MICROSOFT
# ------------------------------------------------------------------------------

MICROSOFT_CLIENT_ID=
MICROSOFT_CLIENT_SECRET=
MICROSOFT_TENANT_ID=

# Override redirect URI (optional)
# MICROSOFT_REDIRECT_URI=

# ------------------------------------------------------------------------------
# AI PROVIDERS
# ------------------------------------------------------------------------------

# OpenAI
OPENAI_API_KEY=
OPENAI_MODEL=gpt-4

# Google Gemini
GEMINI_API_KEY=
GEMINI_MODEL=gemini-pro

# Groq
GROQ_API_KEY=

# ------------------------------------------------------------------------------
# OBSERVABILITY
# ------------------------------------------------------------------------------

# ClickHouse for audit logs
CLICKHOUSE_HOST=http://localhost:8123
CLICKHOUSE_USER=default
CLICKHOUSE_PASSWORD=

# Log level: debug, info, warn, error
LOG_LEVEL=info

# ------------------------------------------------------------------------------
# ENCRYPTION
# ------------------------------------------------------------------------------

# Field encryption key (for encrypting sensitive data at rest)
# [REQUIRED for production] - Use: openssl rand -base64 32
FIELD_ENCRYPTION_KEY=
